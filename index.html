<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">

  <title>GeoVAS - Carte des caches</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
  <meta name="theme-color" content="#003D5C">
</head>

<body>

  <!-- NOTIFICATION NOUVELLE CACHE -->
  <div id="notification" class="notification hidden">
    <span class="notification-icon">ğŸ“</span>
    <div class="notification-content">
      <div class="notification-title">Nouvelle cache ajoutÃ©e !</div>
      <div class="notification-message" id="notificationMessage"></div>
    </div>
    <button class="notification-close" onclick="closeNotification()">Ã—</button>
  </div>

  <!-- ğŸ”µ TOP BAR COMPLET -->
  <header>

    <div class="header-title">
      <img src="logo-pm.jpeg" alt="Police Municipale" class="header-logo-pm">
      <h2>GeoVAS â€“ Caches</h2>
    </div>

    <!-- ğŸ” BARRE DE RECHERCHE + BOUTONS PRINCIPAUX -->
    <div class="search-row">
      <div id="topSearch">
        <input type="text" id="searchInput" placeholder="Adresse ou lieuâ€¦">
        <button id="searchBtn">ğŸ”</button>
      </div>
      <button id="btnGPS" class="quick-btn">ğŸ“ GPS</button>
      <button id="btnAdminToggle" class="quick-btn" onclick="toggleAdminMode()">ğŸ”“ Admin</button>
    </div>

    <!-- LISTE AUTOCOMPLÃ‰TION -->
    <ul id="autocompleteList" class="hidden"></ul>

    <!-- âš™ï¸ BOUTONS ADMIN -->
    <div id="topButtons">
      <button id="btnExport" class="admin-only" style="display:none;">ğŸ’¾ Export</button>
      <button id="btnClear" class="admin-only" style="display:none;">ğŸ”„ Reset</button>
      <button id="btnDelete" class="admin-only" style="display:none;">ğŸ—‘ï¸ Supprimer</button>
    </div>

  </header>

  <!-- ğŸ”² POPUP TYPE DE CACHE -->
  <div id="typePopup" class="hidden">
    <label>Type de cache :</label>
    <select id="cacheType">
      <option value="Trappe tÃ©lÃ©com">Trappe tÃ©lÃ©com</option>
      <option value="Trappe chauffage urbain">Trappe chauffage urbain</option>
      <option value="Autre">Autre</option>
    </select>
    <button id="validateType">Valider</button>
    <button id="cancelType">Annuler</button>
  </div>

  <!-- ğŸ” POPUP AUTHENTIFICATION ADMIN -->
  <div id="adminPopup" class="hidden">
    <h3>ğŸ” AccÃ¨s Administrateur</h3>
    <label>Mot de passe :</label>
    <input type="password" id="adminPassword" placeholder="Entrez le mot de passe">
    <div class="admin-buttons">
      <button id="validateAdmin" onclick="validateAdminPassword()">Valider</button>
      <button id="cancelAdmin" onclick="closeAdminPopup()">Annuler</button>
    </div>
    <p class="admin-hint">ğŸ’¡ Mot de passe : <code>admin123</code></p>
  </div>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="script.js"></script>

  <script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }
  </script>

</body>
</html>